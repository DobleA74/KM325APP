<%- include('../partials/document-start', { pageTitle: (typeof pageTitle !== 'undefined' && pageTitle) ? pageTitle : 'Calendario' }) %>
<%- include('../partials/topbar', { topbarMode: (typeof topbarMode !== 'undefined' && topbarMode) ? topbarMode : 'rrhh', subtitle: 'Gestión RRHH' }) %>

  <main class="container">
    <header class="page-header">
      <h1>Calendario de turnos</h1>
      <p class="muted">Patrón por empleado + excepciones (vacaciones/licencias/cambios).</p>
    </header>

    <section class="card">
      <div style="display:flex; gap:12px; flex-wrap:wrap;">
        <div class="field">
          <label for="c_empleado">Empleado</label>
          <select id="c_empleado"></select>
        </div>

        <div class="field">
          <label for="c_desde">Desde</label>
          <input type="date" id="c_desde" />
        </div>

        <div class="field">
          <label for="c_hasta">Hasta</label>
          <input type="date" id="c_hasta" />
        </div>

        <div class="field">
          <label>&nbsp;</label>
          <button class="btn btn-primary" id="btn_cargar">Cargar</button>
        </div>
      </div>

      <div class="divider"></div>

      <div style="display:flex; gap:12px; flex-wrap:wrap;">
        <div class="field">
          <label for="c_patron">Patrón</label>
          <select id="c_patron"></select>
        </div>

        <div class="field">
          <label for="c_inicio_patron">Inicio del patrón</label>
          <input type="date" id="c_inicio_patron" />
        </div>

        <div class="field">
          <label>&nbsp;</label>
          <button class="btn" id="btn_guardar_patron">Asignar patrón</button>
        </div>
      </div>

      <p class="muted" id="patron_info"></p>
    </section>

    <section class="card">
      <div class="table-wrap">
        <table class="table" id="tabla_calendario">
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Puesto</th>
              <th>Turno</th>
              <th>Horario</th>
              <th>Fuente</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <p class="muted" id="cal_msg"></p>
    </section>

    <!-- Modal Excepción -->
    <div class="modal" id="modal_ex" aria-hidden="true">
      <div class="modal-card">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px;">
          <h3>Excepción</h3>
          <button class="btn btn-light" id="ex_close">Cerrar</button>
        </div>

        <div >
          <div style="display:flex; gap:12px; flex-wrap:wrap;">
            <div class="field">
              <label>Legajo</label>
              <input type="text" id="ex_legajo" readonly />
            </div>
            <div class="field">
              <label>Fecha</label>
              <input type="date" id="ex_fecha" readonly />
            </div>
            <div class="field">
              <label>Tipo</label>
              <select id="ex_tipo">
                <option value="CAMBIO">Cambio (turno / puesto)</option>
              <option value="FRANCO_EXTRA">Franco</option>
              <option value="VACACIONES">Vacaciones</option>
              <option value="LICENCIA">Licencia</option>
              <option value="ENFERMEDAD">Enfermedad</option>
              <option value="PERMISO">Permiso</option>
                <option value="VACACIONES">Vacaciones</option>
                <option value="LICENCIA">Licencia</option>
                <option value="PERMISO">Permiso</option>
                <option value="ENFERMEDAD">Enfermedad</option>
                <option value="FRANCO_EXTRA">Franco extra</option>
              </select>
            </div>
            <div class="field">
              <label>Puesto (opcional)</label>
              <input type="text" id="ex_puesto" placeholder="Ej: Playero/a" />
            </div>
            <div class="field">
              <label>Turno (opcional)</label>
              <select id="ex_turno">
                <option value="">(sin cambio)</option>
                <option value="MANIANA">Mañana</option>
                <option value="TARDE">Tarde</option>
                <option value="NOCHE">Noche</option>
                <option value="FRANCO">Franco</option>
              </select>
            </div>
            <div class="field">
              <label>Motivo</label>
              <input type="text" id="ex_motivo" placeholder="Opcional" />
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-primary" id="ex_guardar">Guardar</button>
          <button class="btn btn-danger" id="ex_eliminar" style="display:none;">Eliminar</button>
        </div>
      </div>
    </div>

  </main>

<%- include('../partials/footer') %>

<script src="/calendario.js"></script>
<%- include('../partials/document-end') %>
